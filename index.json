{"repository_name":"wgsim","body":"# wgsim.cr\n\n[![build](https://github.com/kojix2/wgsim.cr/actions/workflows/build.yml/badge.svg)](https://github.com/kojix2/wgsim.cr/actions/workflows/build.yml)\n\nTrying to re-implement and add functionality to [wgsim](https://github.com/lh3/wgsim) in Crystal.\n\n:black_cat: Please note that this project has been created for personal learning and experimental purposes and is not intended for practical use.\n\n## Installation\n\n[GitHub Releases](https://github.com/kojix2/wgsim.cr/releases/latest)\n\nFrom source:\n\n```sh\ngit clone https://github.com/kojix2/wgsim.cr\ncd wgsim.cr\nshards build --release -Dpreview_mt src/wgsim.cr\n```\n\n## Usage\n\n```\n  Program: wgsim (Crystal implementation of wgsim)\n  Version: 0.0.1.alpha\n    mut          mutate the reference\n    seq          generate the reads\n    version      show version number\n```\n\n```\n  Usage: wgsim mut [options] <in.ref.fa>\n\n    -r FLOAT     rate of mutations [0.001]\n    -R FLOAT     fraction of indels [0.15]\n    -X FLOAT     probability an indel is extended [0.3]\n    -S UINT64    seed for random generator\n    -t INT       Number of threads [4]\n    --help       show this help message\n```\n\n```\n  Usage: wgsim seq [options] <in.ref.fa> <out.read1.fq> <out.read2.fq>\n\n    -e FLOAT     base error rate [0.02]\n    -d INT       outer distance between the two ends [500]\n    -s INT       standard deviation [50]\n    -D FLOAT     average sequencing depth [10.0]\n    -1 INT       length of the first read [70]\n    -2 INT       length of the second read [70]\n    -A FLOAT     Discard reads over FLOAT% ambiguous bases [0.05]\n    -S UINT64    seed for random generator\n    -t INT       Number of threads [4]\n    --help       show this help message\n```\n\n## NOTE\n\n- The tool provides two simulation classes: `MutationSimulator` and `SequenceSimulator`. (You may also want to add a `SelectionSimulator`.)\n- The key point is to include the complete DNA sequence of the cell's genome in the Fasta file. In the case of diploid cells, two Fasta records should be added for each pair of homologous chromosomes. When there is an increase in chromosome copy number due to extrachromosomal DNA, additional records must be included in the Fasta file to reflect this amplification. If a chromosome undergoes inversion or fusion, the Fasta file should contain a record that accurately represents these changes. This means that the genome should not be represented in any compressed form on the computer. Consequently, there will be as many `UInt8` or `RefBase` structures as there are nucleotides. While this approach may reduce processing speed and increase disk and memory usage, it helps to avoid many complications.\n- [wgsimのコードを眺める [JA]](https://qiita.com/kojix2/items/35318fbefe0e2ea9fca1)\n  \n## Contributing\n\n1. Fork it (<https://github.com/kojix2/wgsim/fork>)\n2. Create your feature branch (`git checkout -b my-new-feature`)\n3. Commit your changes (`git commit -am 'Add some feature'`)\n4. Push to the branch (`git push origin my-new-feature`)\n5. Create a new Pull Request\n","program":{"html_id":"wgsim/toplevel","path":"toplevel.html","kind":"module","full_name":"Top Level Namespace","name":"Top Level Namespace","abstract":false,"locations":[],"repository_name":"wgsim","program":true,"enum":false,"alias":false,"const":false,"types":[{"html_id":"wgsim/OptionParser","path":"OptionParser.html","kind":"class","full_name":"OptionParser","name":"OptionParser","abstract":false,"superclass":{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/ext/option_parser.cr","line_number":1,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/ext/option_parser.cr#L1"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"subclasses":[{"html_id":"wgsim/Wgsim/Parser","kind":"class","full_name":"Wgsim::Parser","name":"Parser"}],"doc":"`OptionParser` is a class for command-line options processing. It supports:\n\n* Short and long modifier style options (example: `-h`, `--help`)\n* Passing arguments to the flags (example: `-f filename.txt`)\n* Subcommands\n* Automatic help message generation\n\nRun `crystal` for an example of a CLI built with `OptionParser`.\n\nNOTE: To use `OptionParser`, you must explicitly import it with `require \"option_parser\"`\n\nShort example:\n\n```\nrequire \"option_parser\"\n\nupcase = false\ndestination = \"World\"\n\nOptionParser.parse do |parser|\n  parser.banner = \"Usage: salute [arguments]\"\n  parser.on(\"-u\", \"--upcase\", \"Upcases the salute\") { upcase = true }\n  parser.on(\"-t NAME\", \"--to=NAME\", \"Specifies the name to salute\") { |name| destination = name }\n  parser.on(\"-h\", \"--help\", \"Show this help\") do\n    puts parser\n    exit\n  end\n  parser.invalid_option do |flag|\n    STDERR.puts \"ERROR: #{flag} is not a valid option.\"\n    STDERR.puts parser\n    exit(1)\n  end\nend\n\ndestination = destination.upcase if upcase\nputs \"Hello #{destination}!\"\n```\n\n# Subcommands\n\n`OptionParser` also supports subcommands.\n\nShort example:\n\n```\nrequire \"option_parser\"\n\nverbose = false\nsalute = false\nwelcome = false\nname = \"World\"\nparser = OptionParser.new do |parser|\n  parser.banner = \"Usage: example [subcommand] [arguments]\"\n  parser.on(\"salute\", \"Salute a name\") do\n    salute = true\n    parser.banner = \"Usage: example salute [arguments]\"\n    parser.on(\"-t NAME\", \"--to=NAME\", \"Specify the name to salute\") { |_name| name = _name }\n  end\n  parser.on(\"welcome\", \"Print a greeting message\") do\n    welcome = true\n    parser.banner = \"Usage: example welcome\"\n  end\n  parser.on(\"-v\", \"--verbose\", \"Enabled verbose output\") { verbose = true }\n  parser.on(\"-h\", \"--help\", \"Show this help\") do\n    puts parser\n    exit\n  end\nend\n\nparser.parse\n\nif salute\n  STDERR.puts \"Saluting #{name}\" if verbose\n  puts \"Hello #{name}\"\nelsif welcome\n  STDERR.puts \"Welcoming #{name}\" if verbose\n  puts \"Welcome!\"\nelse\n  puts parser\n  exit(1)\nend\n```","summary":"<p><code><a href=\"OptionParser.html\">OptionParser</a></code> is a class for command-line options processing.</p>","macros":[{"html_id":"m_on(short_type,desc,field)-macro","name":"m_on","abstract":false,"args":[{"name":"short_type","external_name":"short_type","restriction":""},{"name":"desc","external_name":"desc","restriction":""},{"name":"field","external_name":"field","restriction":""}],"args_string":"(short_type, desc, field)","args_html":"(short_type, desc, field)","location":{"filename":"src/ext/option_parser.cr","line_number":2,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/ext/option_parser.cr#L2"},"def":{"name":"m_on","args":[{"name":"short_type","external_name":"short_type","restriction":""},{"name":"desc","external_name":"desc","restriction":""},{"name":"field","external_name":"field","restriction":""}],"visibility":"Public","body":"    \n{% short, ctype = short_type.split %}\n\n    \n{% if ctype == \"INT\"\n  type = \"to_i32\"\nend %}\n\n    \n{% if ctype == \"UINT\"\n  type = \"to_u32\"\nend %}\n\n    \n{% if ctype == \"INT64\"\n  type = \"to_i64\"\nend %}\n\n    \n{% if ctype == \"UINT64\"\n  type = \"to_u64\"\nend %}\n\n    \n{% if ctype == \"FLOAT\"\n  type = \"to_f64\"\nend %}\n\n    on(\"\n{{ short.id }}\n \n{{ ctype.id }}\n\", \"\n{{ desc.id }}\n [#{@options.mut.\n{{ field.id }}\n}]\") do |v|\n      begin\n        @options.mut.\n{{ field.id }}\n = v.\n{{ type.id }}\n\n      rescue \nex\n        Utils.print_error! \"\n{{ short_type.id }}\n: #{ex.message}\"\n      \nend\n    \nend\n  \n"}},{"html_id":"s_on(short_type,desc,field)-macro","name":"s_on","abstract":false,"args":[{"name":"short_type","external_name":"short_type","restriction":""},{"name":"desc","external_name":"desc","restriction":""},{"name":"field","external_name":"field","restriction":""}],"args_string":"(short_type, desc, field)","args_html":"(short_type, desc, field)","location":{"filename":"src/ext/option_parser.cr","line_number":18,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/ext/option_parser.cr#L18"},"def":{"name":"s_on","args":[{"name":"short_type","external_name":"short_type","restriction":""},{"name":"desc","external_name":"desc","restriction":""},{"name":"field","external_name":"field","restriction":""}],"visibility":"Public","body":"    \n{% short, ctype = short_type.split %}\n\n    \n{% if ctype == \"INT\"\n  type = \"to_i32\"\nend %}\n\n    \n{% if ctype == \"UINT\"\n  type = \"to_u32\"\nend %}\n\n    \n{% if ctype == \"INT64\"\n  type = \"to_i64\"\nend %}\n\n    \n{% if ctype == \"UINT64\"\n  type = \"to_u64\"\nend %}\n\n    \n{% if ctype == \"FLOAT\"\n  type = \"to_f64\"\nend %}\n\n    on(\"\n{{ short.id }}\n \n{{ ctype.id }}\n\", \"\n{{ desc.id }}\n [#{@options.seq.\n{{ field.id }}\n}]\") do |v|\n      begin\n        @options.seq.\n{{ field.id }}\n = v.\n{{ type.id }}\n\n      rescue \nex\n        Utils.print_error! \"\n{{ short_type.id }}\n: #{ex.message}\"\n      \nend\n    \nend\n  \n"}}]},{"html_id":"wgsim/Wgsim","path":"Wgsim.html","kind":"module","full_name":"Wgsim","name":"Wgsim","abstract":false,"locations":[{"filename":"src/wgsim.cr","line_number":7,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim.cr#L7"},{"filename":"src/wgsim/action.cr","line_number":1,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/action.cr#L1"},{"filename":"src/wgsim/application.cr","line_number":7,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/application.cr#L7"},{"filename":"src/wgsim/mutation_simulator.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L3"},{"filename":"src/wgsim/options.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L3"},{"filename":"src/wgsim/parser.cr","line_number":9,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L9"},{"filename":"src/wgsim/rand.cr","line_number":1,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/rand.cr#L1"},{"filename":"src/wgsim/read_fasta.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/read_fasta.cr#L3"},{"filename":"src/wgsim/ref_base.cr","line_number":1,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L1"},{"filename":"src/wgsim/sequence_simulator.cr","line_number":1,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L1"},{"filename":"src/wgsim/utils.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/utils.cr#L3"},{"filename":"src/wgsim/version.cr","line_number":1,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/version.cr#L1"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"VERSION","name":"VERSION","value":"{{ (`shards version /home/runner/work/wgsim.cr/wgsim.cr/src/wgsim`).chomp.stringify }}"}],"class_methods":[{"html_id":"run-class-method","name":"run","abstract":false,"location":{"filename":"src/wgsim.cr","line_number":8,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim.cr#L8"},"def":{"name":"run","visibility":"Public","body":"options = Wgsim::Parser.new.parse\napp = Wgsim::Application.new(options)\napp.run\n"}}],"types":[{"html_id":"wgsim/Wgsim/Action","path":"Wgsim/Action.html","kind":"enum","full_name":"Wgsim::Action","name":"Action","abstract":false,"ancestors":[{"html_id":"wgsim/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"wgsim/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"wgsim/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/action.cr","line_number":2,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/action.cr#L2"}],"repository_name":"wgsim","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"MUT","name":"MUT","value":"0_u8"},{"id":"SEQ","name":"SEQ","value":"1_u8"}],"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"instance_methods":[{"html_id":"mut?-instance-method","name":"mut?","abstract":false,"location":{"filename":"src/wgsim/action.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/action.cr#L3"},"def":{"name":"mut?","visibility":"Public","body":"self == MUT"}},{"html_id":"seq?-instance-method","name":"seq?","abstract":false,"location":{"filename":"src/wgsim/action.cr","line_number":4,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/action.cr#L4"},"def":{"name":"seq?","visibility":"Public","body":"self == SEQ"}}]},{"html_id":"wgsim/Wgsim/Application","path":"Wgsim/Application.html","kind":"class","full_name":"Wgsim::Application","name":"Application","abstract":false,"superclass":{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/application.cr","line_number":8,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/application.cr#L8"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"constructors":[{"html_id":"new(options:Options)-class-method","name":"new","abstract":false,"args":[{"name":"options","external_name":"options","restriction":"Options"}],"args_string":"(options : Options)","args_html":"(options : <a href=\"../Wgsim/Options.html\">Options</a>)","location":{"filename":"src/wgsim/application.cr","line_number":9,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/application.cr#L9"},"def":{"name":"new","args":[{"name":"options","external_name":"options","restriction":"Options"}],"visibility":"Public","body":"_ = allocate\n_.initialize(options)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"run-instance-method","name":"run","abstract":false,"location":{"filename":"src/wgsim/application.cr","line_number":13,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/application.cr#L13"},"def":{"name":"run","visibility":"Public","body":"case @options.command\nwhen Action::MUT\n  run_mut\nwhen Action::SEQ\n  run_seq\nelse\n  raise(\"Unknown command\")\nend"}},{"html_id":"run_mut-instance-method","name":"run_mut","abstract":false,"location":{"filename":"src/wgsim/application.cr","line_number":24,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/application.cr#L24"},"def":{"name":"run_mut","visibility":"Public","body":"mopts = @options.mut\nreference = mopts.reference.not_nil!\nmutation_simulator = MutationSimulator.new(mopts.mutation_rate, mopts.indel_fraction, mopts.indel_extension_probability, random: @random)\nSTDERR.puts(\"[wgsim] #{mopts}\")\nReadFasta.each_contig(reference) do |name, sequence|\n  STDERR.puts(\"[wgsim] #{name} #{sequence.size} bp\")\n  reference_sequence = ReadFasta.normalize_sequence(sequence)\n  2.times do |i|\n    pname = \"#{name.split.first}_#{i}\"\n    puts(\">#{pname}\")\n    mutated_sequence = mutation_simulator.simulate_mutations(pname, reference_sequence)\n    seq = IO::Memory.new\n    mutated_sequence.each do |b|\n      case b.mutation_type\n      when MutType::NOCHANGE, MutType::SUBSTITUTE\n        seq.write_byte(b.nucleotide)\n      when MutType::DELETE\n      when MutType::INSERT\n        seq.write_byte(b.nucleotide)\n        ins = b.insertion\n        if ins\n          seq.write(ins)\n        end\n      end\n    end\n    puts(seq.to_s.gsub(/(.{80})/, \"\\\\1\\n\"))\n  end\nend\n"}},{"html_id":"run_seq-instance-method","name":"run_seq","abstract":false,"location":{"filename":"src/wgsim/application.cr","line_number":58,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/application.cr#L58"},"def":{"name":"run_seq","visibility":"Public","body":"sopts = @options.seq\nreference = sopts.reference.not_nil!\noutput1 = sopts.output1.not_nil!\noutput2 = sopts.output2.not_nil!\nsequence_simulator = SequenceSimulator.new(sopts.average_depth, sopts.distance, sopts.std_deviation, sopts.size_left, sopts.size_right, sopts.error_rate, sopts.max_ambiguous_ratio, random: @random)\noutput_fasta_1 = File.open(output1, \"w\")\noutput_fasta_2 = File.open(output2, \"w\")\nnames = [] of String\nchannel = Channel(String).new\nReadFasta.each_contig(reference) do |name, sequence|\n  names << name\n  normalized_sequence = ReadFasta.normalize_sequence(sequence)\n  spawn do\n    sequence_simulator.run(name, normalized_sequence) do |record1, record2|\n      output_fasta_1.puts(record1)\n      output_fasta_2.puts(record2)\n    end\n    channel.send(name)\n  end\nend\nwhile names.present?\n  name = channel.receive\n  names.delete(name)\n  STDERR.puts(\"[wgsim] #{name} done\")\nend\noutput_fasta_1.close\noutput_fasta_2.close\n"}}]},{"html_id":"wgsim/Wgsim/MutationOptions","path":"Wgsim/MutationOptions.html","kind":"struct","full_name":"Wgsim::MutationOptions","name":"MutationOptions","abstract":false,"superclass":{"html_id":"wgsim/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"wgsim/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"wgsim/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/options.cr","line_number":11,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L11"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":11,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L11"},"def":{"name":"new","visibility":"Public","body":"x = allocate\nif x.responds_to?(:finalize)\n  ::GC.add_finalizer(x)\nend\nx\n"}}],"instance_methods":[{"html_id":"indel_extension_probability:Float64-instance-method","name":"indel_extension_probability","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":14,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L14"},"def":{"name":"indel_extension_probability","return_type":"Float64","visibility":"Public","body":"@indel_extension_probability"}},{"html_id":"indel_extension_probability=(indel_extension_probability:Float64)-instance-method","name":"indel_extension_probability=","abstract":false,"args":[{"name":"indel_extension_probability","external_name":"indel_extension_probability","restriction":"Float64"}],"args_string":"(indel_extension_probability : Float64)","args_html":"(indel_extension_probability : Float64)","location":{"filename":"src/wgsim/options.cr","line_number":14,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L14"},"def":{"name":"indel_extension_probability=","args":[{"name":"indel_extension_probability","external_name":"indel_extension_probability","restriction":"Float64"}],"visibility":"Public","body":"@indel_extension_probability = indel_extension_probability"}},{"html_id":"indel_fraction:Float64-instance-method","name":"indel_fraction","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":13,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L13"},"def":{"name":"indel_fraction","return_type":"Float64","visibility":"Public","body":"@indel_fraction"}},{"html_id":"indel_fraction=(indel_fraction:Float64)-instance-method","name":"indel_fraction=","abstract":false,"args":[{"name":"indel_fraction","external_name":"indel_fraction","restriction":"Float64"}],"args_string":"(indel_fraction : Float64)","args_html":"(indel_fraction : Float64)","location":{"filename":"src/wgsim/options.cr","line_number":13,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L13"},"def":{"name":"indel_fraction=","args":[{"name":"indel_fraction","external_name":"indel_fraction","restriction":"Float64"}],"visibility":"Public","body":"@indel_fraction = indel_fraction"}},{"html_id":"initialize-instance-method","name":"initialize","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":11,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L11"},"def":{"name":"initialize","visibility":"Public","body":""}},{"html_id":"mutation_rate:Float64-instance-method","name":"mutation_rate","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":12,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L12"},"def":{"name":"mutation_rate","return_type":"Float64","visibility":"Public","body":"@mutation_rate"}},{"html_id":"mutation_rate=(mutation_rate:Float64)-instance-method","name":"mutation_rate=","abstract":false,"args":[{"name":"mutation_rate","external_name":"mutation_rate","restriction":"Float64"}],"args_string":"(mutation_rate : Float64)","args_html":"(mutation_rate : Float64)","location":{"filename":"src/wgsim/options.cr","line_number":12,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L12"},"def":{"name":"mutation_rate=","args":[{"name":"mutation_rate","external_name":"mutation_rate","restriction":"Float64"}],"visibility":"Public","body":"@mutation_rate = mutation_rate"}},{"html_id":"reference:Path|Nil-instance-method","name":"reference","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":15,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L15"},"def":{"name":"reference","return_type":"Path | ::Nil","visibility":"Public","body":"@reference"}},{"html_id":"reference=(reference:Path|Nil)-instance-method","name":"reference=","abstract":false,"args":[{"name":"reference","external_name":"reference","restriction":"Path | ::Nil"}],"args_string":"(reference : Path | Nil)","args_html":"(reference : Path | Nil)","location":{"filename":"src/wgsim/options.cr","line_number":15,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L15"},"def":{"name":"reference=","args":[{"name":"reference","external_name":"reference","restriction":"Path | ::Nil"}],"visibility":"Public","body":"@reference = reference"}}]},{"html_id":"wgsim/Wgsim/MutationSimulator","path":"Wgsim/MutationSimulator.html","kind":"class","full_name":"Wgsim::MutationSimulator","name":"MutationSimulator","abstract":false,"superclass":{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/mutation_simulator.cr","line_number":4,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L4"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"constants":[{"id":"ACG","name":"ACG","value":"StaticArray[65_u8, 67_u8, 71_u8]"},{"id":"ACGT","name":"ACGT","value":"StaticArray[65_u8, 67_u8, 71_u8, 84_u8]"},{"id":"ACT","name":"ACT","value":"StaticArray[65_u8, 67_u8, 84_u8]"},{"id":"AGT","name":"AGT","value":"StaticArray[65_u8, 71_u8, 84_u8]"},{"id":"CGT","name":"CGT","value":"StaticArray[67_u8, 71_u8, 84_u8]"}],"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"constructors":[{"html_id":"new(mutation_rate:Float64,indel_fraction:Float64,indel_extension_probability:Float64,random:Wgsim::Rand=Rand.new)-class-method","name":"new","abstract":false,"args":[{"name":"mutation_rate","external_name":"mutation_rate","restriction":"::Float64"},{"name":"indel_fraction","external_name":"indel_fraction","restriction":"::Float64"},{"name":"indel_extension_probability","external_name":"indel_extension_probability","restriction":"::Float64"},{"name":"random","default_value":"Rand.new","external_name":"random","restriction":"::Wgsim::Rand"}],"args_string":"(mutation_rate : Float64, indel_fraction : Float64, indel_extension_probability : Float64, random : Wgsim::Rand = Rand.new)","args_html":"(mutation_rate : Float64, indel_fraction : Float64, indel_extension_probability : Float64, random : <a href=\"../Wgsim/Rand.html\">Wgsim::Rand</a> = <span class=\"t\">Rand</span>.new)","location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":10,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L10"},"def":{"name":"new","args":[{"name":"mutation_rate","external_name":"mutation_rate","restriction":"::Float64"},{"name":"indel_fraction","external_name":"indel_fraction","restriction":"::Float64"},{"name":"indel_extension_probability","external_name":"indel_extension_probability","restriction":"::Float64"},{"name":"random","default_value":"Rand.new","external_name":"random","restriction":"::Wgsim::Rand"}],"visibility":"Public","body":"_ = allocate\n_.initialize(mutation_rate, indel_fraction, indel_extension_probability, random)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"_rand(*args,**options)-instance-method","name":"_rand","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options)","args_html":"(*args, **options)","location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L5"},"def":{"name":"_rand","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"visibility":"Public","body":"@random._rand(*args, **options)"}},{"html_id":"_rand(*args,**options,&)-instance-method","name":"_rand","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options, &)","args_html":"(*args, **options, &)","location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L5"},"def":{"name":"_rand","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"yields":1,"block_arity":1,"visibility":"Public","body":"@random._rand(*args, **options) do |*yield_args|\n  yield *yield_args\nend"}},{"html_id":"generate_insertion:Slice(UInt8)-instance-method","name":"generate_insertion","abstract":false,"location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":39,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L39"},"def":{"name":"generate_insertion","return_type":"Slice(UInt8)","visibility":"Public","body":"siz = 1\nwhile _rand <= indel_extension_probability\n  siz = siz + 1\nend\nSlice(UInt8).new(siz) do\n  ACGT.sample\nend\n"}},{"html_id":"indel_extension_probability:Float64-instance-method","name":"indel_extension_probability","abstract":false,"location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":8,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L8"},"def":{"name":"indel_extension_probability","return_type":"Float64","visibility":"Public","body":"@indel_extension_probability"}},{"html_id":"indel_fraction:Float64-instance-method","name":"indel_fraction","abstract":false,"location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":7,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L7"},"def":{"name":"indel_fraction","return_type":"Float64","visibility":"Public","body":"@indel_fraction"}},{"html_id":"mutation_rate:Float64-instance-method","name":"mutation_rate","abstract":false,"location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":6,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L6"},"def":{"name":"mutation_rate","return_type":"Float64","visibility":"Public","body":"@mutation_rate"}},{"html_id":"perform_substitution(nucleotide:UInt8):UInt8-instance-method","name":"perform_substitution","abstract":false,"args":[{"name":"nucleotide","external_name":"nucleotide","restriction":"UInt8"}],"args_string":"(nucleotide : UInt8) : UInt8","args_html":"(nucleotide : UInt8) : UInt8","location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":24,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L24"},"def":{"name":"perform_substitution","args":[{"name":"nucleotide","external_name":"nucleotide","restriction":"UInt8"}],"return_type":"UInt8","visibility":"Public","body":"case nucleotide\nwhen 65_u8\n  CGT.sample\nwhen 67_u8\n  AGT.sample\nwhen 71_u8\n  ACT.sample\nwhen 84_u8\n  ACG.sample\nelse\n  78_u8\nend"}},{"html_id":"rand_bool(*args,**options)-instance-method","name":"rand_bool","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options)","args_html":"(*args, **options)","location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L5"},"def":{"name":"rand_bool","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"visibility":"Public","body":"@random.rand_bool(*args, **options)"}},{"html_id":"rand_bool(*args,**options,&)-instance-method","name":"rand_bool","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options, &)","args_html":"(*args, **options, &)","location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L5"},"def":{"name":"rand_bool","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"yields":1,"block_arity":1,"visibility":"Public","body":"@random.rand_bool(*args, **options) do |*yield_args|\n  yield *yield_args\nend"}},{"html_id":"rand_norm(*args,**options)-instance-method","name":"rand_norm","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options)","args_html":"(*args, **options)","location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L5"},"def":{"name":"rand_norm","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"visibility":"Public","body":"@random.rand_norm(*args, **options)"}},{"html_id":"rand_norm(*args,**options,&)-instance-method","name":"rand_norm","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options, &)","args_html":"(*args, **options, &)","location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L5"},"def":{"name":"rand_norm","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"yields":1,"block_arity":1,"visibility":"Public","body":"@random.rand_norm(*args, **options) do |*yield_args|\n  yield *yield_args\nend"}},{"html_id":"simulate_mutations(name:String,sequence:Slice(UInt8)):Slice(RefBase)-instance-method","name":"simulate_mutations","abstract":false,"args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"sequence","external_name":"sequence","restriction":"Slice(UInt8)"}],"args_string":"(name : String, sequence : Slice(UInt8)) : Slice(RefBase)","args_html":"(name : String, sequence : Slice(UInt8)) : Slice(<a href=\"../Wgsim/RefBase.html\">RefBase</a>)","location":{"filename":"src/wgsim/mutation_simulator.cr","line_number":50,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/mutation_simulator.cr#L50"},"def":{"name":"simulate_mutations","args":[{"name":"name","external_name":"name","restriction":"String"},{"name":"sequence","external_name":"sequence","restriction":"Slice(UInt8)"}],"return_type":"Slice(RefBase)","visibility":"Public","body":"deleting = [] of UInt8\nsequence.map_with_index do |n, i|\n  if deleting.present?\n    if _rand < indel_extension_probability\n      deleting << n\n      next RefBase.new(nucleotide: n, mutation_type: MutType::DELETE)\n    else\n      delseq = deleting.map do |n|\n        n.chr\n      end.join\n      STDERR.puts([\"[wgsim]\", \"DEL\", name, (i - deleting.size) + 1, delseq, \".\"].join(\"\\t\"))\n      deleting.clear\n    end\n  end\n  if _rand < mutation_rate && (n != 78_u8)\n    if _rand > indel_fraction\n      nn = perform_substitution(n)\n      STDERR.puts([\"[wgsim]\", \"SUB\", name, i + 1, n.chr, nn.chr].join(\"\\t\"))\n      RefBase.new(nucleotide: nn, mutation_type: MutType::SUBSTITUTE)\n    else\n      if _rand < 0.5\n        deleting << n\n        RefBase.new(nucleotide: n, mutation_type: MutType::DELETE)\n      else\n        ins = generate_insertion\n        STDERR.puts([\"[wgsim]\", \"INS\", name, i + 1, n.chr, n.chr + (String.new(ins))].join(\"\\t\"))\n        RefBase.new(nucleotide: n, mutation_type: MutType::INSERT, insertion: ins)\n      end\n    end\n  else\n    RefBase.new(nucleotide: n, mutation_type: MutType::NOCHANGE)\n  end\nend\n"}}]},{"html_id":"wgsim/Wgsim/MutType","path":"Wgsim/MutType.html","kind":"enum","full_name":"Wgsim::MutType","name":"MutType","abstract":false,"ancestors":[{"html_id":"wgsim/Enum","kind":"struct","full_name":"Enum","name":"Enum"},{"html_id":"wgsim/Comparable","kind":"module","full_name":"Comparable","name":"Comparable"},{"html_id":"wgsim/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/ref_base.cr","line_number":2,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L2"}],"repository_name":"wgsim","program":false,"enum":true,"alias":false,"const":false,"constants":[{"id":"NOCHANGE","name":"NOCHANGE","value":"0_u8"},{"id":"SUBSTITUTE","name":"SUBSTITUTE","value":"1_u8"},{"id":"DELETE","name":"DELETE","value":"2_u8"},{"id":"INSERT","name":"INSERT","value":"3_u8"}],"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"instance_methods":[{"html_id":"delete?-instance-method","name":"delete?","abstract":false,"location":{"filename":"src/wgsim/ref_base.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L5"},"def":{"name":"delete?","visibility":"Public","body":"self == DELETE"}},{"html_id":"insert?-instance-method","name":"insert?","abstract":false,"location":{"filename":"src/wgsim/ref_base.cr","line_number":6,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L6"},"def":{"name":"insert?","visibility":"Public","body":"self == INSERT"}},{"html_id":"nochange?-instance-method","name":"nochange?","abstract":false,"location":{"filename":"src/wgsim/ref_base.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L3"},"def":{"name":"nochange?","visibility":"Public","body":"self == NOCHANGE"}},{"html_id":"substitute?-instance-method","name":"substitute?","abstract":false,"location":{"filename":"src/wgsim/ref_base.cr","line_number":4,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L4"},"def":{"name":"substitute?","visibility":"Public","body":"self == SUBSTITUTE"}}]},{"html_id":"wgsim/Wgsim/Options","path":"Wgsim/Options.html","kind":"struct","full_name":"Wgsim::Options","name":"Options","abstract":false,"superclass":{"html_id":"wgsim/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"wgsim/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"wgsim/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/options.cr","line_number":4,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L4"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":4,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L4"},"def":{"name":"new","visibility":"Public","body":"x = allocate\nif x.responds_to?(:finalize)\n  ::GC.add_finalizer(x)\nend\nx\n"}}],"instance_methods":[{"html_id":"command:Action|Nil-instance-method","name":"command","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L5"},"def":{"name":"command","return_type":"Action | ::Nil","visibility":"Public","body":"@command"}},{"html_id":"command=(command:Action|Nil)-instance-method","name":"command=","abstract":false,"args":[{"name":"command","external_name":"command","restriction":"Action | ::Nil"}],"args_string":"(command : Action | Nil)","args_html":"(command : <a href=\"../Wgsim/Action.html\">Action</a> | Nil)","location":{"filename":"src/wgsim/options.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L5"},"def":{"name":"command=","args":[{"name":"command","external_name":"command","restriction":"Action | ::Nil"}],"visibility":"Public","body":"@command = command"}},{"html_id":"initialize-instance-method","name":"initialize","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":4,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L4"},"def":{"name":"initialize","visibility":"Public","body":""}},{"html_id":"mut:MutationOptions-instance-method","name":"mut","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":7,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L7"},"def":{"name":"mut","return_type":"MutationOptions","visibility":"Public","body":"@mut"}},{"html_id":"mut=(mut:MutationOptions)-instance-method","name":"mut=","abstract":false,"args":[{"name":"mut","external_name":"mut","restriction":"MutationOptions"}],"args_string":"(mut : MutationOptions)","args_html":"(mut : <a href=\"../Wgsim/MutationOptions.html\">MutationOptions</a>)","location":{"filename":"src/wgsim/options.cr","line_number":7,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L7"},"def":{"name":"mut=","args":[{"name":"mut","external_name":"mut","restriction":"MutationOptions"}],"visibility":"Public","body":"@mut = mut"}},{"html_id":"seed:UInt64|Nil-instance-method","name":"seed","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":6,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L6"},"def":{"name":"seed","return_type":"UInt64 | ::Nil","visibility":"Public","body":"@seed"}},{"html_id":"seed=(seed:UInt64|Nil)-instance-method","name":"seed=","abstract":false,"args":[{"name":"seed","external_name":"seed","restriction":"UInt64 | ::Nil"}],"args_string":"(seed : UInt64 | Nil)","args_html":"(seed : UInt64 | Nil)","location":{"filename":"src/wgsim/options.cr","line_number":6,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L6"},"def":{"name":"seed=","args":[{"name":"seed","external_name":"seed","restriction":"UInt64 | ::Nil"}],"visibility":"Public","body":"@seed = seed"}},{"html_id":"seq:SequenceOptions-instance-method","name":"seq","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":8,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L8"},"def":{"name":"seq","return_type":"SequenceOptions","visibility":"Public","body":"@seq"}},{"html_id":"seq=(seq:SequenceOptions)-instance-method","name":"seq=","abstract":false,"args":[{"name":"seq","external_name":"seq","restriction":"SequenceOptions"}],"args_string":"(seq : SequenceOptions)","args_html":"(seq : <a href=\"../Wgsim/SequenceOptions.html\">SequenceOptions</a>)","location":{"filename":"src/wgsim/options.cr","line_number":8,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L8"},"def":{"name":"seq=","args":[{"name":"seq","external_name":"seq","restriction":"SequenceOptions"}],"visibility":"Public","body":"@seq = seq"}}]},{"html_id":"wgsim/Wgsim/Parser","path":"Wgsim/Parser.html","kind":"class","full_name":"Wgsim::Parser","name":"Parser","abstract":false,"superclass":{"html_id":"wgsim/OptionParser","kind":"class","full_name":"OptionParser","name":"OptionParser"},"ancestors":[{"html_id":"wgsim/OptionParser","kind":"class","full_name":"OptionParser","name":"OptionParser"},{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/parser.cr","line_number":10,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L10"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/wgsim/parser.cr","line_number":11,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L11"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"parse(argv=ARGV)-instance-method","name":"parse","doc":"Parses the passed *args* (defaults to `ARGV`), running the handlers associated to each option.","summary":"<p>Parses the passed <em>args</em> (defaults to <code>ARGV</code>), running the handlers associated to each option.</p>","abstract":false,"args":[{"name":"argv","default_value":"ARGV","external_name":"argv","restriction":""}],"args_string":"(argv = ARGV)","args_html":"(argv = <span class=\"t\">ARGV</span>)","location":{"filename":"src/wgsim/parser.cr","line_number":52,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L52"},"def":{"name":"parse","args":[{"name":"argv","default_value":"ARGV","external_name":"argv","restriction":""}],"visibility":"Public","body":"super(argv)\ncase @options.command\nwhen Action::MUT\n  parse_mut(argv)\nwhen Action::SEQ\n  parse_seq(argv)\nwhen \"\"\n  show_help!(1)\nelse\n  Utils.print_error!(\"Invalid command: #{@options.command}\")\nend\n@options\n"}},{"html_id":"parse_mut(argv=ARGV)-instance-method","name":"parse_mut","abstract":false,"args":[{"name":"argv","default_value":"ARGV","external_name":"argv","restriction":""}],"args_string":"(argv = ARGV)","args_html":"(argv = <span class=\"t\">ARGV</span>)","location":{"filename":"src/wgsim/parser.cr","line_number":67,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L67"},"def":{"name":"parse_mut","args":[{"name":"argv","default_value":"ARGV","external_name":"argv","restriction":""}],"visibility":"Public","body":"validate_arguments(argv, 1)\n@options.mut.reference = Path.new(argv.shift)\nvalidate_file_exists(@options.mut.reference)\n"}},{"html_id":"parse_seq(argv=ARGV)-instance-method","name":"parse_seq","abstract":false,"args":[{"name":"argv","default_value":"ARGV","external_name":"argv","restriction":""}],"args_string":"(argv = ARGV)","args_html":"(argv = <span class=\"t\">ARGV</span>)","location":{"filename":"src/wgsim/parser.cr","line_number":73,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L73"},"def":{"name":"parse_seq","args":[{"name":"argv","default_value":"ARGV","external_name":"argv","restriction":""}],"visibility":"Public","body":"validate_arguments(argv, 3)\n@options.seq.reference = Path.new(argv.shift)\nvalidate_file_exists(@options.seq.reference)\n@options.seq.output1 = Path.new(argv.shift)\n@options.seq.output2 = Path.new(argv.shift)\n"}},{"html_id":"show_help(n=0)-instance-method","name":"show_help","abstract":false,"args":[{"name":"n","default_value":"0","external_name":"n","restriction":""}],"args_string":"(n = 0)","args_html":"(n = <span class=\"n\">0</span>)","location":{"filename":"src/wgsim/parser.cr","line_number":91,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L91"},"def":{"name":"show_help","args":[{"name":"n","default_value":"0","external_name":"n","restriction":""}],"visibility":"Public","body":"if n == 0\n  puts\n  puts(self)\n  puts\nelse\n  STDERR.puts\n  STDERR.puts(self)\n  STDERR.puts\nend"}},{"html_id":"show_help!(n=0)-instance-method","name":"show_help!","abstract":false,"args":[{"name":"n","default_value":"0","external_name":"n","restriction":""}],"args_string":"(n = 0)","args_html":"(n = <span class=\"n\">0</span>)","location":{"filename":"src/wgsim/parser.cr","line_number":86,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L86"},"def":{"name":"show_help!","args":[{"name":"n","default_value":"0","external_name":"n","restriction":""}],"visibility":"Public","body":"show_help(n)\nexit(n)\n"}},{"html_id":"show_version-instance-method","name":"show_version","abstract":false,"location":{"filename":"src/wgsim/parser.cr","line_number":81,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L81"},"def":{"name":"show_version","visibility":"Public","body":"puts(Wgsim::VERSION)\nexit\n"}},{"html_id":"validate_arguments(argv,siz)-instance-method","name":"validate_arguments","abstract":false,"args":[{"name":"argv","external_name":"argv","restriction":""},{"name":"siz","external_name":"siz","restriction":""}],"args_string":"(argv, siz)","args_html":"(argv, siz)","location":{"filename":"src/wgsim/parser.cr","line_number":103,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L103"},"def":{"name":"validate_arguments","args":[{"name":"argv","external_name":"argv","restriction":""},{"name":"siz","external_name":"siz","restriction":""}],"visibility":"Public","body":"case argv.size\nwhen siz\nwhen 0\n  show_help(1)\n  Utils.print_error!(\"Use --help for more information\\n\")\nelse\n  show_help(1)\n  Utils.print_error!(\"Invalid arguments\\n\")\nend"}},{"html_id":"validate_file_exists(file)-instance-method","name":"validate_file_exists","abstract":false,"args":[{"name":"file","external_name":"file","restriction":""}],"args_string":"(file)","args_html":"(file)","location":{"filename":"src/wgsim/parser.cr","line_number":116,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/parser.cr#L116"},"def":{"name":"validate_file_exists","args":[{"name":"file","external_name":"file","restriction":""}],"visibility":"Public","body":"if File.exists?(file.not_nil!)\nelse\n  Utils.print_error!(\"File not found: #{file}\")\nend"}}]},{"html_id":"wgsim/Wgsim/Rand","path":"Wgsim/Rand.html","kind":"class","full_name":"Wgsim::Rand","name":"Rand","abstract":false,"superclass":{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/rand.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/rand.cr#L3"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"doc":"The Rand class generates random numbers from a normal distribution.","summary":"<p>The Rand class generates random numbers from a normal distribution.</p>","constructors":[{"html_id":"new(seed:UInt64)-class-method","name":"new","abstract":false,"args":[{"name":"seed","external_name":"seed","restriction":"UInt64"}],"args_string":"(seed : UInt64)","args_html":"(seed : UInt64)","location":{"filename":"src/wgsim/rand.cr","line_number":8,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/rand.cr#L8"},"def":{"name":"new","args":[{"name":"seed","external_name":"seed","restriction":"UInt64"}],"visibility":"Public","body":"_ = allocate\n_.initialize(seed)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}},{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/wgsim/rand.cr","line_number":12,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/rand.cr#L12"},"def":{"name":"new","visibility":"Public","body":"_ = allocate\n_.initialize\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"_rand(n:Int32):Int32-instance-method","name":"_rand","abstract":false,"args":[{"name":"n","external_name":"n","restriction":"Int32"}],"args_string":"(n : Int32) : Int32","args_html":"(n : Int32) : Int32","location":{"filename":"src/wgsim/rand.cr","line_number":51,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/rand.cr#L51"},"def":{"name":"_rand","args":[{"name":"n","external_name":"n","restriction":"Int32"}],"return_type":"Int32","visibility":"Public","body":"(@random.next_float * n).to_i"}},{"html_id":"_rand:Float64-instance-method","name":"_rand","abstract":false,"location":{"filename":"src/wgsim/rand.cr","line_number":47,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/rand.cr#L47"},"def":{"name":"_rand","return_type":"Float64","visibility":"Public","body":"@random.next_float"}},{"html_id":"rand_bool:Bool-instance-method","name":"rand_bool","abstract":false,"location":{"filename":"src/wgsim/rand.cr","line_number":55,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/rand.cr#L55"},"def":{"name":"rand_bool","return_type":"Bool","visibility":"Public","body":"@random.next_bool"}},{"html_id":"rand_norm(mean,std_dev):Float64-instance-method","name":"rand_norm","doc":"Generates a random number from a normal distribution with the specified mean and standard deviation.","summary":"<p>Generates a random number from a normal distribution with the specified mean and standard deviation.</p>","abstract":false,"args":[{"name":"mean","external_name":"mean","restriction":""},{"name":"std_dev","external_name":"std_dev","restriction":""}],"args_string":"(mean, std_dev) : Float64","args_html":"(mean, std_dev) : Float64","location":{"filename":"src/wgsim/rand.cr","line_number":38,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/rand.cr#L38"},"def":{"name":"rand_norm","args":[{"name":"mean","external_name":"mean","restriction":""},{"name":"std_dev","external_name":"std_dev","restriction":""}],"return_type":"Float64","visibility":"Public","body":"mean = mean.to_f\nstd_dev = std_dev.to_f\nif std_dev.negative?\n  raise(\"std_dev must be positive\")\nend\nmean + (std_dev * rand_norm())\n"}},{"html_id":"rand_norm:Float64-instance-method","name":"rand_norm","doc":"Generates a random number from a standard normal distribution.","summary":"<p>Generates a random number from a standard normal distribution.</p>","abstract":false,"location":{"filename":"src/wgsim/rand.cr","line_number":17,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/rand.cr#L17"},"def":{"name":"rand_norm","return_type":"Float64","visibility":"Public","body":"if @iset == 0\n  rsq, v1, v2, fac = 0.0, 0.0, 0.0, 0.0\n  loop do\n    v1 = (2.0 * @random.next_float) - 1.0\n    v2 = (2.0 * @random.next_float) - 1.0\n    rsq = (v1 * v1) + (v2 * v2)\n    if rsq < 1.0 && (rsq != 0.0)\n      break\n    end\n  end\n  fac = Math.sqrt((-2.0 * (Math.log(rsq))) / rsq)\n  @gset = v1 * fac\n  @iset = 1\n  return v2 * fac\nelse\n  @iset = 0\n  return @gset\nend"}}]},{"html_id":"wgsim/Wgsim/ReadFasta","path":"Wgsim/ReadFasta.html","kind":"module","full_name":"Wgsim::ReadFasta","name":"ReadFasta","abstract":false,"locations":[{"filename":"src/wgsim/read_fasta.cr","line_number":4,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/read_fasta.cr#L4"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"extended_modules":[{"html_id":"wgsim/Wgsim/ReadFasta","kind":"module","full_name":"Wgsim::ReadFasta","name":"ReadFasta"}],"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"instance_methods":[{"html_id":"each_contig(filename:Path|String,&)-instance-method","name":"each_contig","abstract":false,"args":[{"name":"filename","external_name":"filename","restriction":"Path | String"}],"args_string":"(filename : Path | String, &)","args_html":"(filename : Path | String, &)","location":{"filename":"src/wgsim/read_fasta.cr","line_number":7,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/read_fasta.cr#L7"},"def":{"name":"each_contig","args":[{"name":"filename","external_name":"filename","restriction":"Path | String"}],"yields":2,"block_arity":2,"visibility":"Public","body":"filename = Path.new(filename)\nFile.open(filename) do |file|\n  if filename.extension == \".gz\"\n    file = Compress::Gzip::Reader.new(file)\n  end\n  name = nil\n  sequence = IO::Memory.new\n  file.each_line(chomp = true) do |line|\n    if line.starts_with?(\">\")\n      if name.nil?\n      else\n        yield name, sequence\n      end\n      name = line[1..-1]\n      sequence = IO::Memory.new\n    else\n      if line.ascii_only?\n        sequence << line\n      else\n        raise(\"[wgsim] Non-ASCII characters in FASTA file: #{filename}\\n  #{name}\\n  #{sequence}\")\n      end\n    end\n  end\n  if filename.extension == \".gz\"\n    file.close\n  end\n  if name.nil?\n  else\n    yield name, sequence\n  end\nend\n"}},{"html_id":"normalize_base(c:UInt8):UInt8-instance-method","name":"normalize_base","abstract":false,"args":[{"name":"c","external_name":"c","restriction":"UInt8"}],"args_string":"(c : UInt8) : UInt8","args_html":"(c : UInt8) : UInt8","location":{"filename":"src/wgsim/read_fasta.cr","line_number":38,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/read_fasta.cr#L38"},"def":{"name":"normalize_base","args":[{"name":"c","external_name":"c","restriction":"UInt8"}],"return_type":"UInt8","visibility":"Public","body":"case c\nwhen 65_u8, 97_u8\n  65_u8\nwhen 67_u8, 99_u8\n  67_u8\nwhen 71_u8, 103_u8\n  71_u8\nwhen 84_u8, 116_u8\n  84_u8\nwhen 78_u8, 110_u8\n  78_u8\nelse\n  STDERR.puts(\"[wgsim] '#{c.chr}' is replaced with 'N'\")\n  78_u8\nend"}},{"html_id":"normalize_sequence(sequence:IO::Memory|String):Slice(UInt8)-instance-method","name":"normalize_sequence","abstract":false,"args":[{"name":"sequence","external_name":"sequence","restriction":"IO::Memory | String"}],"args_string":"(sequence : IO::Memory | String) : Slice(UInt8)","args_html":"(sequence : IO::Memory | String) : Slice(UInt8)","location":{"filename":"src/wgsim/read_fasta.cr","line_number":51,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/read_fasta.cr#L51"},"def":{"name":"normalize_sequence","args":[{"name":"sequence","external_name":"sequence","restriction":"IO::Memory | String"}],"return_type":"Slice(UInt8)","visibility":"Public","body":"sequence.to_slice.map do |c|\n  normalize_base(c)\nend"}},{"html_id":"normalize_sequence(sequence:IO::Memory|String,&):Slice-instance-method","name":"normalize_sequence","abstract":false,"args":[{"name":"sequence","external_name":"sequence","restriction":"IO::Memory | String"}],"args_string":"(sequence : IO::Memory | String, &) : Slice","args_html":"(sequence : IO::Memory | String, &) : Slice","location":{"filename":"src/wgsim/read_fasta.cr","line_number":57,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/read_fasta.cr#L57"},"def":{"name":"normalize_sequence","args":[{"name":"sequence","external_name":"sequence","restriction":"IO::Memory | String"}],"yields":1,"block_arity":1,"return_type":"Slice","visibility":"Public","body":"sequence.to_slice.map do |c|\n  yield normalize_base(c)\nend"}}]},{"html_id":"wgsim/Wgsim/RefBase","path":"Wgsim/RefBase.html","kind":"struct","full_name":"Wgsim::RefBase","name":"RefBase","abstract":false,"superclass":{"html_id":"wgsim/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"wgsim/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"wgsim/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/ref_base.cr","line_number":9,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L9"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"constructors":[{"html_id":"new(nucleotide:UInt8,mutation_type:Wgsim::MutType,insertion:Slice(UInt8)|Nil=nil)-class-method","name":"new","abstract":false,"args":[{"name":"nucleotide","external_name":"nucleotide","restriction":"::UInt8"},{"name":"mutation_type","external_name":"mutation_type","restriction":"::Wgsim::MutType"},{"name":"insertion","default_value":"nil","external_name":"insertion","restriction":"::Slice(::UInt8) | ::Nil"}],"args_string":"(nucleotide : UInt8, mutation_type : Wgsim::MutType, insertion : Slice(UInt8) | Nil = nil)","args_html":"(nucleotide : UInt8, mutation_type : <a href=\"../Wgsim/MutType.html\">Wgsim::MutType</a>, insertion : Slice(UInt8) | Nil = <span class=\"n\">nil</span>)","location":{"filename":"src/wgsim/ref_base.cr","line_number":14,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L14"},"def":{"name":"new","args":[{"name":"nucleotide","external_name":"nucleotide","restriction":"::UInt8"},{"name":"mutation_type","external_name":"mutation_type","restriction":"::Wgsim::MutType"},{"name":"insertion","default_value":"nil","external_name":"insertion","restriction":"::Slice(::UInt8) | ::Nil"}],"visibility":"Public","body":"_ = allocate\n_.initialize(nucleotide, mutation_type, insertion)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"insertion:Slice(UInt8)|Nil-instance-method","name":"insertion","abstract":false,"location":{"filename":"src/wgsim/ref_base.cr","line_number":12,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L12"},"def":{"name":"insertion","return_type":"Slice(UInt8) | ::Nil","visibility":"Public","body":"@insertion"}},{"html_id":"insertion=(insertion:Slice(UInt8)|Nil)-instance-method","name":"insertion=","abstract":false,"args":[{"name":"insertion","external_name":"insertion","restriction":"Slice(UInt8) | ::Nil"}],"args_string":"(insertion : Slice(UInt8) | Nil)","args_html":"(insertion : Slice(UInt8) | Nil)","location":{"filename":"src/wgsim/ref_base.cr","line_number":12,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L12"},"def":{"name":"insertion=","args":[{"name":"insertion","external_name":"insertion","restriction":"Slice(UInt8) | ::Nil"}],"visibility":"Public","body":"@insertion = insertion"}},{"html_id":"mutation_type:MutType-instance-method","name":"mutation_type","abstract":false,"location":{"filename":"src/wgsim/ref_base.cr","line_number":11,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L11"},"def":{"name":"mutation_type","return_type":"MutType","visibility":"Public","body":"@mutation_type"}},{"html_id":"mutation_type=(mutation_type:MutType)-instance-method","name":"mutation_type=","abstract":false,"args":[{"name":"mutation_type","external_name":"mutation_type","restriction":"MutType"}],"args_string":"(mutation_type : MutType)","args_html":"(mutation_type : <a href=\"../Wgsim/MutType.html\">MutType</a>)","location":{"filename":"src/wgsim/ref_base.cr","line_number":11,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L11"},"def":{"name":"mutation_type=","args":[{"name":"mutation_type","external_name":"mutation_type","restriction":"MutType"}],"visibility":"Public","body":"@mutation_type = mutation_type"}},{"html_id":"nucleotide:UInt8-instance-method","name":"nucleotide","abstract":false,"location":{"filename":"src/wgsim/ref_base.cr","line_number":10,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L10"},"def":{"name":"nucleotide","return_type":"UInt8","visibility":"Public","body":"@nucleotide"}},{"html_id":"nucleotide=(nucleotide:UInt8)-instance-method","name":"nucleotide=","abstract":false,"args":[{"name":"nucleotide","external_name":"nucleotide","restriction":"UInt8"}],"args_string":"(nucleotide : UInt8)","args_html":"(nucleotide : UInt8)","location":{"filename":"src/wgsim/ref_base.cr","line_number":10,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/ref_base.cr#L10"},"def":{"name":"nucleotide=","args":[{"name":"nucleotide","external_name":"nucleotide","restriction":"UInt8"}],"visibility":"Public","body":"@nucleotide = nucleotide"}}]},{"html_id":"wgsim/Wgsim/SequenceOptions","path":"Wgsim/SequenceOptions.html","kind":"struct","full_name":"Wgsim::SequenceOptions","name":"SequenceOptions","abstract":false,"superclass":{"html_id":"wgsim/Struct","kind":"struct","full_name":"Struct","name":"Struct"},"ancestors":[{"html_id":"wgsim/Struct","kind":"struct","full_name":"Struct","name":"Struct"},{"html_id":"wgsim/Value","kind":"struct","full_name":"Value","name":"Value"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/options.cr","line_number":18,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L18"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"constructors":[{"html_id":"new-class-method","name":"new","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":18,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L18"},"def":{"name":"new","visibility":"Public","body":"x = allocate\nif x.responds_to?(:finalize)\n  ::GC.add_finalizer(x)\nend\nx\n"}}],"instance_methods":[{"html_id":"average_depth:Float64-instance-method","name":"average_depth","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":22,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L22"},"def":{"name":"average_depth","return_type":"Float64","visibility":"Public","body":"@average_depth"}},{"html_id":"average_depth=(average_depth:Float64)-instance-method","name":"average_depth=","abstract":false,"args":[{"name":"average_depth","external_name":"average_depth","restriction":"Float64"}],"args_string":"(average_depth : Float64)","args_html":"(average_depth : Float64)","location":{"filename":"src/wgsim/options.cr","line_number":22,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L22"},"def":{"name":"average_depth=","args":[{"name":"average_depth","external_name":"average_depth","restriction":"Float64"}],"visibility":"Public","body":"@average_depth = average_depth"}},{"html_id":"distance:Int32-instance-method","name":"distance","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":20,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L20"},"def":{"name":"distance","return_type":"Int32","visibility":"Public","body":"@distance"}},{"html_id":"distance=(distance:Int32)-instance-method","name":"distance=","abstract":false,"args":[{"name":"distance","external_name":"distance","restriction":"Int32"}],"args_string":"(distance : Int32)","args_html":"(distance : Int32)","location":{"filename":"src/wgsim/options.cr","line_number":20,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L20"},"def":{"name":"distance=","args":[{"name":"distance","external_name":"distance","restriction":"Int32"}],"visibility":"Public","body":"@distance = distance"}},{"html_id":"error_rate:Float64-instance-method","name":"error_rate","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":19,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L19"},"def":{"name":"error_rate","return_type":"Float64","visibility":"Public","body":"@error_rate"}},{"html_id":"error_rate=(error_rate:Float64)-instance-method","name":"error_rate=","abstract":false,"args":[{"name":"error_rate","external_name":"error_rate","restriction":"Float64"}],"args_string":"(error_rate : Float64)","args_html":"(error_rate : Float64)","location":{"filename":"src/wgsim/options.cr","line_number":19,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L19"},"def":{"name":"error_rate=","args":[{"name":"error_rate","external_name":"error_rate","restriction":"Float64"}],"visibility":"Public","body":"@error_rate = error_rate"}},{"html_id":"indel_extension_probability:Float64-instance-method","name":"indel_extension_probability","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":27,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L27"},"def":{"name":"indel_extension_probability","return_type":"Float64","visibility":"Public","body":"@indel_extension_probability"}},{"html_id":"indel_extension_probability=(indel_extension_probability:Float64)-instance-method","name":"indel_extension_probability=","abstract":false,"args":[{"name":"indel_extension_probability","external_name":"indel_extension_probability","restriction":"Float64"}],"args_string":"(indel_extension_probability : Float64)","args_html":"(indel_extension_probability : Float64)","location":{"filename":"src/wgsim/options.cr","line_number":27,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L27"},"def":{"name":"indel_extension_probability=","args":[{"name":"indel_extension_probability","external_name":"indel_extension_probability","restriction":"Float64"}],"visibility":"Public","body":"@indel_extension_probability = indel_extension_probability"}},{"html_id":"indel_fraction:Float64-instance-method","name":"indel_fraction","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":26,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L26"},"def":{"name":"indel_fraction","return_type":"Float64","visibility":"Public","body":"@indel_fraction"}},{"html_id":"indel_fraction=(indel_fraction:Float64)-instance-method","name":"indel_fraction=","abstract":false,"args":[{"name":"indel_fraction","external_name":"indel_fraction","restriction":"Float64"}],"args_string":"(indel_fraction : Float64)","args_html":"(indel_fraction : Float64)","location":{"filename":"src/wgsim/options.cr","line_number":26,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L26"},"def":{"name":"indel_fraction=","args":[{"name":"indel_fraction","external_name":"indel_fraction","restriction":"Float64"}],"visibility":"Public","body":"@indel_fraction = indel_fraction"}},{"html_id":"initialize-instance-method","name":"initialize","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":18,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L18"},"def":{"name":"initialize","visibility":"Public","body":""}},{"html_id":"max_ambiguous_ratio:Float64-instance-method","name":"max_ambiguous_ratio","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":28,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L28"},"def":{"name":"max_ambiguous_ratio","return_type":"Float64","visibility":"Public","body":"@max_ambiguous_ratio"}},{"html_id":"max_ambiguous_ratio=(max_ambiguous_ratio:Float64)-instance-method","name":"max_ambiguous_ratio=","abstract":false,"args":[{"name":"max_ambiguous_ratio","external_name":"max_ambiguous_ratio","restriction":"Float64"}],"args_string":"(max_ambiguous_ratio : Float64)","args_html":"(max_ambiguous_ratio : Float64)","location":{"filename":"src/wgsim/options.cr","line_number":28,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L28"},"def":{"name":"max_ambiguous_ratio=","args":[{"name":"max_ambiguous_ratio","external_name":"max_ambiguous_ratio","restriction":"Float64"}],"visibility":"Public","body":"@max_ambiguous_ratio = max_ambiguous_ratio"}},{"html_id":"mutation_rate:Float64-instance-method","name":"mutation_rate","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":25,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L25"},"def":{"name":"mutation_rate","return_type":"Float64","visibility":"Public","body":"@mutation_rate"}},{"html_id":"mutation_rate=(mutation_rate:Float64)-instance-method","name":"mutation_rate=","abstract":false,"args":[{"name":"mutation_rate","external_name":"mutation_rate","restriction":"Float64"}],"args_string":"(mutation_rate : Float64)","args_html":"(mutation_rate : Float64)","location":{"filename":"src/wgsim/options.cr","line_number":25,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L25"},"def":{"name":"mutation_rate=","args":[{"name":"mutation_rate","external_name":"mutation_rate","restriction":"Float64"}],"visibility":"Public","body":"@mutation_rate = mutation_rate"}},{"html_id":"output1:Path|Nil-instance-method","name":"output1","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":30,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L30"},"def":{"name":"output1","return_type":"Path | ::Nil","visibility":"Public","body":"@output1"}},{"html_id":"output1=(output1:Path|Nil)-instance-method","name":"output1=","abstract":false,"args":[{"name":"output1","external_name":"output1","restriction":"Path | ::Nil"}],"args_string":"(output1 : Path | Nil)","args_html":"(output1 : Path | Nil)","location":{"filename":"src/wgsim/options.cr","line_number":30,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L30"},"def":{"name":"output1=","args":[{"name":"output1","external_name":"output1","restriction":"Path | ::Nil"}],"visibility":"Public","body":"@output1 = output1"}},{"html_id":"output2:Path|Nil-instance-method","name":"output2","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":31,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L31"},"def":{"name":"output2","return_type":"Path | ::Nil","visibility":"Public","body":"@output2"}},{"html_id":"output2=(output2:Path|Nil)-instance-method","name":"output2=","abstract":false,"args":[{"name":"output2","external_name":"output2","restriction":"Path | ::Nil"}],"args_string":"(output2 : Path | Nil)","args_html":"(output2 : Path | Nil)","location":{"filename":"src/wgsim/options.cr","line_number":31,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L31"},"def":{"name":"output2=","args":[{"name":"output2","external_name":"output2","restriction":"Path | ::Nil"}],"visibility":"Public","body":"@output2 = output2"}},{"html_id":"reference:Path|Nil-instance-method","name":"reference","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":29,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L29"},"def":{"name":"reference","return_type":"Path | ::Nil","visibility":"Public","body":"@reference"}},{"html_id":"reference=(reference:Path|Nil)-instance-method","name":"reference=","abstract":false,"args":[{"name":"reference","external_name":"reference","restriction":"Path | ::Nil"}],"args_string":"(reference : Path | Nil)","args_html":"(reference : Path | Nil)","location":{"filename":"src/wgsim/options.cr","line_number":29,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L29"},"def":{"name":"reference=","args":[{"name":"reference","external_name":"reference","restriction":"Path | ::Nil"}],"visibility":"Public","body":"@reference = reference"}},{"html_id":"size_left:Int32-instance-method","name":"size_left","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":23,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L23"},"def":{"name":"size_left","return_type":"Int32","visibility":"Public","body":"@size_left"}},{"html_id":"size_left=(size_left:Int32)-instance-method","name":"size_left=","abstract":false,"args":[{"name":"size_left","external_name":"size_left","restriction":"Int32"}],"args_string":"(size_left : Int32)","args_html":"(size_left : Int32)","location":{"filename":"src/wgsim/options.cr","line_number":23,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L23"},"def":{"name":"size_left=","args":[{"name":"size_left","external_name":"size_left","restriction":"Int32"}],"visibility":"Public","body":"@size_left = size_left"}},{"html_id":"size_right:Int32-instance-method","name":"size_right","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":24,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L24"},"def":{"name":"size_right","return_type":"Int32","visibility":"Public","body":"@size_right"}},{"html_id":"size_right=(size_right:Int32)-instance-method","name":"size_right=","abstract":false,"args":[{"name":"size_right","external_name":"size_right","restriction":"Int32"}],"args_string":"(size_right : Int32)","args_html":"(size_right : Int32)","location":{"filename":"src/wgsim/options.cr","line_number":24,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L24"},"def":{"name":"size_right=","args":[{"name":"size_right","external_name":"size_right","restriction":"Int32"}],"visibility":"Public","body":"@size_right = size_right"}},{"html_id":"std_deviation:Int32-instance-method","name":"std_deviation","abstract":false,"location":{"filename":"src/wgsim/options.cr","line_number":21,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L21"},"def":{"name":"std_deviation","return_type":"Int32","visibility":"Public","body":"@std_deviation"}},{"html_id":"std_deviation=(std_deviation:Int32)-instance-method","name":"std_deviation=","abstract":false,"args":[{"name":"std_deviation","external_name":"std_deviation","restriction":"Int32"}],"args_string":"(std_deviation : Int32)","args_html":"(std_deviation : Int32)","location":{"filename":"src/wgsim/options.cr","line_number":21,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/options.cr#L21"},"def":{"name":"std_deviation=","args":[{"name":"std_deviation","external_name":"std_deviation","restriction":"Int32"}],"visibility":"Public","body":"@std_deviation = std_deviation"}}]},{"html_id":"wgsim/Wgsim/SequenceSimulator","path":"Wgsim/SequenceSimulator.html","kind":"class","full_name":"Wgsim::SequenceSimulator","name":"SequenceSimulator","abstract":false,"superclass":{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},"ancestors":[{"html_id":"wgsim/Reference","kind":"class","full_name":"Reference","name":"Reference"},{"html_id":"wgsim/Object","kind":"class","full_name":"Object","name":"Object"}],"locations":[{"filename":"src/wgsim/sequence_simulator.cr","line_number":2,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L2"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"constructors":[{"html_id":"new(average_depth:Float64,distance:Int32,std_deviation:Int32,size_left:Int32,size_right:Int32,error_rate:Float64,max_ambiguous_ratio:Float64,random:Wgsim::Rand=Rand.new)-class-method","name":"new","abstract":false,"args":[{"name":"average_depth","external_name":"average_depth","restriction":"::Float64"},{"name":"distance","external_name":"distance","restriction":"::Int32"},{"name":"std_deviation","external_name":"std_deviation","restriction":"::Int32"},{"name":"size_left","external_name":"size_left","restriction":"::Int32"},{"name":"size_right","external_name":"size_right","restriction":"::Int32"},{"name":"error_rate","external_name":"error_rate","restriction":"::Float64"},{"name":"max_ambiguous_ratio","external_name":"max_ambiguous_ratio","restriction":"::Float64"},{"name":"random","default_value":"Rand.new","external_name":"random","restriction":"::Wgsim::Rand"}],"args_string":"(average_depth : Float64, distance : Int32, std_deviation : Int32, size_left : Int32, size_right : Int32, error_rate : Float64, max_ambiguous_ratio : Float64, random : Wgsim::Rand = Rand.new)","args_html":"(average_depth : Float64, distance : Int32, std_deviation : Int32, size_left : Int32, size_right : Int32, error_rate : Float64, max_ambiguous_ratio : Float64, random : <a href=\"../Wgsim/Rand.html\">Wgsim::Rand</a> = <span class=\"t\">Rand</span>.new)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":12,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L12"},"def":{"name":"new","args":[{"name":"average_depth","external_name":"average_depth","restriction":"::Float64"},{"name":"distance","external_name":"distance","restriction":"::Int32"},{"name":"std_deviation","external_name":"std_deviation","restriction":"::Int32"},{"name":"size_left","external_name":"size_left","restriction":"::Int32"},{"name":"size_right","external_name":"size_right","restriction":"::Int32"},{"name":"error_rate","external_name":"error_rate","restriction":"::Float64"},{"name":"max_ambiguous_ratio","external_name":"max_ambiguous_ratio","restriction":"::Float64"},{"name":"random","default_value":"Rand.new","external_name":"random","restriction":"::Wgsim::Rand"}],"visibility":"Public","body":"_ = allocate\n_.initialize(average_depth, distance, std_deviation, size_left, size_right, error_rate, max_ambiguous_ratio, random)\nif _.responds_to?(:finalize)\n  ::GC.add_finalizer(_)\nend\n_\n"}}],"instance_methods":[{"html_id":"_rand(*args,**options)-instance-method","name":"_rand","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options)","args_html":"(*args, **options)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L3"},"def":{"name":"_rand","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"visibility":"Public","body":"@random._rand(*args, **options)"}},{"html_id":"_rand(*args,**options,&)-instance-method","name":"_rand","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options, &)","args_html":"(*args, **options, &)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L3"},"def":{"name":"_rand","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"yields":1,"block_arity":1,"visibility":"Public","body":"@random._rand(*args, **options) do |*yield_args|\n  yield *yield_args\nend"}},{"html_id":"average_depth:Float64-instance-method","name":"average_depth","abstract":false,"location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":6,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L6"},"def":{"name":"average_depth","return_type":"Float64","visibility":"Public","body":"@average_depth"}},{"html_id":"distance:Int32-instance-method","name":"distance","abstract":false,"location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":4,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L4"},"def":{"name":"distance","return_type":"Int32","visibility":"Public","body":"@distance"}},{"html_id":"error_rate:Float64-instance-method","name":"error_rate","abstract":false,"location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":9,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L9"},"def":{"name":"error_rate","return_type":"Float64","visibility":"Public","body":"@error_rate"}},{"html_id":"fasta_record(name,pair_index,position,insert_size,read_index,sequence:Slice(UInt8)):String-instance-method","name":"fasta_record","abstract":false,"args":[{"name":"name","external_name":"name","restriction":""},{"name":"pair_index","external_name":"pair_index","restriction":""},{"name":"position","external_name":"position","restriction":""},{"name":"insert_size","external_name":"insert_size","restriction":""},{"name":"read_index","external_name":"read_index","restriction":""},{"name":"sequence","external_name":"sequence","restriction":"Slice(UInt8)"}],"args_string":"(name, pair_index, position, insert_size, read_index, sequence : Slice(UInt8)) : String","args_html":"(name, pair_index, position, insert_size, read_index, sequence : Slice(UInt8)) : String","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":79,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L79"},"def":{"name":"fasta_record","args":[{"name":"name","external_name":"name","restriction":""},{"name":"pair_index","external_name":"pair_index","restriction":""},{"name":"position","external_name":"position","restriction":""},{"name":"insert_size","external_name":"insert_size","restriction":""},{"name":"read_index","external_name":"read_index","restriction":""},{"name":"sequence","external_name":"sequence","restriction":"Slice(UInt8)"}],"return_type":"String","visibility":"Public","body":"sequence = String.new(sequence)\nString.build do |str|\n  (str << \">#{name}_#{position}_#{insert_size}:#{pair_index}/#{read_index + 1}\") << \"\\n\"\n  (str << sequence) << \"\\n\"\n  (str << \"+\") << \"\\n\"\n  (str << (\"2\" * [size_left, size_right][read_index])) << \"\\n\"\nend\n"}},{"html_id":"generate_pair_sequence(target_seq,position,insert_size,flip):Tuple(Slice(UInt8),Slice(UInt8))-instance-method","name":"generate_pair_sequence","abstract":false,"args":[{"name":"target_seq","external_name":"target_seq","restriction":""},{"name":"position","external_name":"position","restriction":""},{"name":"insert_size","external_name":"insert_size","restriction":""},{"name":"flip","external_name":"flip","restriction":""}],"args_string":"(target_seq, position, insert_size, flip) : Tuple(Slice(UInt8), Slice(UInt8))","args_html":"(target_seq, position, insert_size, flip) : Tuple(Slice(UInt8), Slice(UInt8))","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":67,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L67"},"def":{"name":"generate_pair_sequence","args":[{"name":"target_seq","external_name":"target_seq","restriction":""},{"name":"position","external_name":"position","restriction":""},{"name":"insert_size","external_name":"insert_size","restriction":""},{"name":"flip","external_name":"flip","restriction":""}],"return_type":"Tuple(Slice(UInt8), Slice(UInt8))","visibility":"Public","body":"if flip\n  read1 = target_seq[position...(position + size_left)]\n  read2 = reverse_complement(target_seq[((position + insert_size) - size_right)...(position + insert_size)])\nelse\n  read1 = reverse_complement(target_seq[((position + insert_size) - size_left)...(position + insert_size)])\n  read2 = target_seq[position...(position + size_right)]\nend\n{read1, read2}\n"}},{"html_id":"generate_sequencing_error(sequence:Slice(UInt8)):Slice(UInt8)-instance-method","name":"generate_sequencing_error","abstract":false,"args":[{"name":"sequence","external_name":"sequence","restriction":"Slice(UInt8)"}],"args_string":"(sequence : Slice(UInt8)) : Slice(UInt8)","args_html":"(sequence : Slice(UInt8)) : Slice(UInt8)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":89,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L89"},"def":{"name":"generate_sequencing_error","args":[{"name":"sequence","external_name":"sequence","restriction":"Slice(UInt8)"}],"return_type":"Slice(UInt8)","visibility":"Public","body":"valid_nucleotides = [65_u8, 67_u8, 71_u8, 84_u8]\nsequence.map do |b|\n  case b\n  when 78_u8\n    b\n  when 65_u8, 67_u8, 71_u8, 84_u8\n    if _rand < error_rate\n      other_nucleotides = valid_nucleotides - [b]\n      other_nucleotides[_rand(3)]\n    else\n      b\n    end\n  else\n    raise(\"Invalid nucleotide: #{b}\")\n  end\nend\n"}},{"html_id":"max_ambiguous_ratio:Float64-instance-method","name":"max_ambiguous_ratio","abstract":false,"location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":10,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L10"},"def":{"name":"max_ambiguous_ratio","return_type":"Float64","visibility":"Public","body":"@max_ambiguous_ratio"}},{"html_id":"rand_bool(*args,**options)-instance-method","name":"rand_bool","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options)","args_html":"(*args, **options)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L3"},"def":{"name":"rand_bool","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"visibility":"Public","body":"@random.rand_bool(*args, **options)"}},{"html_id":"rand_bool(*args,**options,&)-instance-method","name":"rand_bool","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options, &)","args_html":"(*args, **options, &)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L3"},"def":{"name":"rand_bool","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"yields":1,"block_arity":1,"visibility":"Public","body":"@random.rand_bool(*args, **options) do |*yield_args|\n  yield *yield_args\nend"}},{"html_id":"rand_norm(*args,**options)-instance-method","name":"rand_norm","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options)","args_html":"(*args, **options)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L3"},"def":{"name":"rand_norm","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"visibility":"Public","body":"@random.rand_norm(*args, **options)"}},{"html_id":"rand_norm(*args,**options,&)-instance-method","name":"rand_norm","abstract":false,"args":[{"name":"args","external_name":"args","restriction":""}],"args_string":"(*args, **options, &)","args_html":"(*args, **options, &)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":3,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L3"},"def":{"name":"rand_norm","args":[{"name":"args","external_name":"args","restriction":""}],"double_splat":{"name":"options","external_name":"options","restriction":""},"splat_index":0,"yields":1,"block_arity":1,"visibility":"Public","body":"@random.rand_norm(*args, **options) do |*yield_args|\n  yield *yield_args\nend"}},{"html_id":"random_insert_size-instance-method","name":"random_insert_size","abstract":false,"location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":122,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L122"},"def":{"name":"random_insert_size","visibility":"Public","body":"[(rand_norm(distance, std_deviation)).to_i, size_left, size_right].max"}},{"html_id":"random_position(contig_length:Int,insert_size:Int)-instance-method","name":"random_position","abstract":false,"args":[{"name":"contig_length","external_name":"contig_length","restriction":"Int"},{"name":"insert_size","external_name":"insert_size","restriction":"Int"}],"args_string":"(contig_length : Int, insert_size : Int)","args_html":"(contig_length : Int, insert_size : Int)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":126,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L126"},"def":{"name":"random_position","args":[{"name":"contig_length","external_name":"contig_length","restriction":"Int"},{"name":"insert_size","external_name":"insert_size","restriction":"Int"}],"visibility":"Public","body":"_rand((contig_length - insert_size) + 1)"}},{"html_id":"reverse_complement(sequence:Slice(UInt8)):Slice(UInt8)-instance-method","name":"reverse_complement","abstract":false,"args":[{"name":"sequence","external_name":"sequence","restriction":"Slice(UInt8)"}],"args_string":"(sequence : Slice(UInt8)) : Slice(UInt8)","args_html":"(sequence : Slice(UInt8)) : Slice(UInt8)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":108,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L108"},"def":{"name":"reverse_complement","args":[{"name":"sequence","external_name":"sequence","restriction":"Slice(UInt8)"}],"return_type":"Slice(UInt8)","visibility":"Public","body":"complements = {65_u8 => 84_u8, 67_u8 => 71_u8, 71_u8 => 67_u8, 84_u8 => 65_u8, 78_u8 => 78_u8}\nsequence.map do |b|\n  complements.fetch(b) do\n    raise(\"Invalid nucleotide: #{b}\")\n  end\nend.reverse!\n"}},{"html_id":"run(name,sequence,&)-instance-method","name":"run","abstract":false,"args":[{"name":"name","external_name":"name","restriction":""},{"name":"sequence","external_name":"sequence","restriction":""}],"args_string":"(name, sequence, &)","args_html":"(name, sequence, &)","location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":24,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L24"},"def":{"name":"run","args":[{"name":"name","external_name":"name","restriction":""},{"name":"sequence","external_name":"sequence","restriction":""}],"yields":2,"block_arity":2,"visibility":"Public","body":"contig_length = sequence.size\nn_pairs = ((contig_length * average_depth) / (size_left + size_right)).to_i\npair_index = 0\nwhile pair_index < n_pairs\n  ((pair_index % (10 ** ((Math.log10(n_pairs)).to_i - 1))) == 0) && (puts(\"[wgsim] #{name} #{pair_index}/#{n_pairs}\"))\n  insert_size = random_insert_size\n  position = random_position(contig_length, insert_size)\n  ((position < 0 || position > contig_length) || ((position + insert_size) - 1) < contig_length) || (raise(\"Invalid position or insert size: position=#{position}, insert_size=#{insert_size}, contig_length=#{contig_length}\"))\n  flip = rand_bool\n  read1_sequence, read2_sequence = generate_pair_sequence(sequence, position, insert_size, flip)\n  if ((read1_sequence.count('N')) / read1_sequence.size) > max_ambiguous_ratio || ((read2_sequence.count('N')) / read2_sequence.size) > max_ambiguous_ratio\n    next\n  end\n  read1_sequence = generate_sequencing_error(read1_sequence)\n  read2_sequence = generate_sequencing_error(read2_sequence)\n  yield(fasta_record(name.split[0], pair_index, position, insert_size, 0, read1_sequence), fasta_record(name.split[0], pair_index, position, insert_size, 1, read2_sequence))\n  pair_index = pair_index + 1\nend\n"}},{"html_id":"size_left:Int32-instance-method","name":"size_left","abstract":false,"location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":7,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L7"},"def":{"name":"size_left","return_type":"Int32","visibility":"Public","body":"@size_left"}},{"html_id":"size_right:Int32-instance-method","name":"size_right","abstract":false,"location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":8,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L8"},"def":{"name":"size_right","return_type":"Int32","visibility":"Public","body":"@size_right"}},{"html_id":"std_deviation:Int32-instance-method","name":"std_deviation","abstract":false,"location":{"filename":"src/wgsim/sequence_simulator.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/sequence_simulator.cr#L5"},"def":{"name":"std_deviation","return_type":"Int32","visibility":"Public","body":"@std_deviation"}}]},{"html_id":"wgsim/Wgsim/Utils","path":"Wgsim/Utils.html","kind":"module","full_name":"Wgsim::Utils","name":"Utils","abstract":false,"locations":[{"filename":"src/wgsim/utils.cr","line_number":4,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/utils.cr#L4"}],"repository_name":"wgsim","program":false,"enum":false,"alias":false,"const":false,"namespace":{"html_id":"wgsim/Wgsim","kind":"module","full_name":"Wgsim","name":"Wgsim"},"class_methods":[{"html_id":"print_error(message:String,color=:default)-class-method","name":"print_error","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"String"},{"name":"color","default_value":":default","external_name":"color","restriction":""}],"args_string":"(message : String, color = :default)","args_html":"(message : String, color = <span class=\"n\">:default</span>)","location":{"filename":"src/wgsim/utils.cr","line_number":10,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/utils.cr#L10"},"def":{"name":"print_error","args":[{"name":"message","external_name":"message","restriction":"String"},{"name":"color","default_value":":default","external_name":"color","restriction":""}],"visibility":"Public","body":"STDERR.print(\"[wgsim] \".colorize.mode(:bold))\nSTDERR.puts((message.colorize.fore(color)).mode(:bold))\n"}},{"html_id":"print_error!(message:String,color=:default)-class-method","name":"print_error!","abstract":false,"args":[{"name":"message","external_name":"message","restriction":"String"},{"name":"color","default_value":":default","external_name":"color","restriction":""}],"args_string":"(message : String, color = :default)","args_html":"(message : String, color = <span class=\"n\">:default</span>)","location":{"filename":"src/wgsim/utils.cr","line_number":5,"url":"https://github.com/kojix2/wgsim.cr/blob/90260dcffa78b51bea77dddc79b653c3b7c526b2/src/wgsim/utils.cr#L5"},"def":{"name":"print_error!","args":[{"name":"message","external_name":"message","restriction":"String"},{"name":"color","default_value":":default","external_name":"color","restriction":""}],"visibility":"Public","body":"print_error(message, color)\nexit(1)\n"}}]}]}]}}